<div class="page-header">
  <div class="col-10 mx-auto">
    <div class="row mx-0 justify-content-between align-items-center">
      <div class="width-fit-content">
        <p class="mb-0 section-header-text">Report Issue Requests
        </p>
        <p class="mb-0 text-size-14">Admin / <span class="child-path-text">Report Issue Requests</span></p>
      </div>
    </div>
  </div>
</div>

<app-arrow-divider [isLightToDark]="true"></app-arrow-divider>

<div *ngIf="reportIssueRequests?.length" class="col 12 col-sm-12 col-md 12 col-lg-12 px-2 dark-background">

  <div class="row mx-0 justify-content-end">
    <div class="red-button mb-4" (click)="exportToExcel()">
      <p class="mb-0">Export To Excel</p>
      <span class="red-button-icon"></span>
    </div>
  </div>

  <div class="col-12 pb-4">
    <table style="width:100%; table-layout: auto;">
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Hanger or Section Number</th>
        <th style="width: 30%;">Issue Description</th>
        <th>Date Captured</th>
        <th>Category</th>
        <th>Person Responsible</th>
        <th>Status</th>
        <th style="width: fit-content;"><div class="row mx-0" style="flex-wrap: nowrap;"><mat-icon class="p-0" fontIcon="edit"></mat-icon><mat-icon
            *ngIf="allowAdminToDelete" class="ml-1 p-0" fontIcon="delete"></mat-icon></div></th>
      </tr>

      <tr *ngFor="let item of reportIssueRequests">
        <td class="text-no-wrap" [innerHTML]="item.id"></td>
        <td class="text-no-wrap" [innerHTML]="item.name"></td>
        <td class="text-no-wrap" [innerHTML]="item.hangerOrSectionNumber"></td>
        <td [innerHTML]="item.issueDescription"></td>
        <td class="text-no-wrap" [innerHTML]="item.dateAdded"></td>

        <td>
          <mat-form-field class="px-0 change-request-form-field" subscriptSizing="dynamic">
            <mat-label>Category</mat-label>
            <mat-select [(value)]="item.category"
              (selectionChange)="updateReportIssueCategory(item.id, $event.value)">
              <mat-option *ngFor="let category of categoryList" class="px-1" [value]="category.category">{{ category.category }}</mat-option>
            </mat-select>
          </mat-form-field>
        </td>

        <td>
          <mat-form-field class="px-0 change-request-form-field" subscriptSizing="dynamic">
            <mat-label>Person Responsible</mat-label>
            <mat-select [(value)]="item.personResponsible"
              (selectionChange)="updateReportIssuePersonResponsible(item.id, $event.value)">
              <mat-option *ngFor="let person of responsiblePersonList" class="px-1" [value]="person.name">{{ person.name }}</mat-option>
            </mat-select>
          </mat-form-field>
        </td>

        <!-- <td class="text-no-wrap text-center"><mat-icon *ngIf="item.hasFollowedUp === '0'"
            class="green-text mr-2 pointer" fontIcon="check"
            (click)="markIssueAsFollowedUpClicked(item)"></mat-icon></td> -->

        <td>
          <mat-form-field class="px-0 change-request-form-field" subscriptSizing="dynamic">
            <mat-label>Status</mat-label>
            <mat-select [(value)]="item.status" (selectionChange)="updateReportIssueStatus(item.id, $event.value)">
              <mat-option class="px-1" value="notStarted">Not Started</mat-option>
              <mat-option class="px-1" value="inProgress">In Progress</mat-option>
              <mat-option class="px-1" value="done">Done</mat-option>
            </mat-select>
          </mat-form-field>
        </td>

        <td><div class="row mx-0"><mat-icon class="red-text pointer p-0" fontIcon="edit"
            (click)="editReportIssueRequestClicked(item)"></mat-icon>
          <mat-icon *ngIf="allowAdminToDelete" class="red-text pointer ml-1 p-0" fontIcon="delete"
            (click)="deleteReportIssueRequestClicked(item)"></mat-icon></div>
        </td>
      </tr>

    </table>
  </div>
</div>

<div *ngIf="!reportIssueRequests?.length" class="col-10 mx-auto">
  <p class="text-size-24">There are currently no issues to review.</p>
</div>